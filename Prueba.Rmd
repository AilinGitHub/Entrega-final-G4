---
title: "TP prueba"
author: "Ailin"
date: "2024-04-25"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Metdología


Para el trabajo se emplearon las siguientes librerias

 install.packages("leaflet")
library(readr)


## Introducción

Vamos a comenzar a trabajar con el dataset de nación Producción de Pet y Gas No convencional de YPF (se filtraron los valores extrayendo la producción de pozos que no eran de la operadora)




```{r}
library(readr)
Produccion_NC_YPF <- read_delim("Produccion NC YPF.csv", 
    delim = ";", escape_double = FALSE, col_types = cols(prod_gas = col_double(), 
        coordenadax = col_number(), coordenaday = col_number()), 
    trim_ws = TRUE)
View(Produccion_NC_YPF)
```


Asignación de la tabla como "Datos"

```{r}
datos <- Produccion_NC_YPF
```



2.	Ver el nombre de los datos de la cabecera de la tabla

Aquí exploraremos el contenido de los datos. Comenzaremos con los nombres de las variables utilizando el comando names

```{r}
names(datos)
```

3.	Dimensiones de la tabla (filas y columnas)

* Para ver las dimensiones (filas y columnas) colocamos el comando dim
```{r}
dim(datos)

```


4.	Cabecera de la tabla

```{r}
head(datos)
```


5.	Pie de la tabla

```{r}
tail(datos)
```
## Producción

De los datos más relevantes de la tabla, son los valores de pruducción de petróleo y gas. Vamos a trabajar con estos valores, observando la cantidad total de valores.

* Producción de petróleo

```{r}
ProdPet <-(datos$prod_pet)
```


```{r}
summary(ProdPet)
```
De estos datos, se observa que la máxima producción de petróleo de uno de los pozos es de 7390.03 m3/d mientras que la menor es de 0 (pozos parados).
La producción promedio del conjunto de pozos no convencionales para el mes de marzo fue de 490m3/d.


A continuación haremos gráficos analizando estos valores:


```{r}
plot(ProdPet, col='steelblue', xlab = "Numero de pozos", ylab = 'Prod Pet m3/d', main = "Distribución de Producción de Petróleo en pozos NC - YPF")
```



```{r}
hist(ProdPet, col='steelblue', xlab = 'Prod Pet m3/d', ylab = 'Numero de pozos', main = "Distribución de Producción de Petróleo en pozos NC - YPF")
abline(v = mean(ProdPet), col='red', lwd = 1)
```

Distribución - desvío estándar




* Producción de GAS

```{r}
ProdGas <-(datos$prod_gas)
```


```{r}
summary(ProdGas)
```
De estos datos, se observa que la máxima producción de GAS de uno de los pozos es de 14212.68 Mm3/d mientras que la menor es de 0 (pozos parados).
La producción promedio del conjunto de pozos no convencionales para el mes de marzo fue de 356.93Mm3/d.


A continuación haremos gráficos analizando estos valores:


```{r}
hist(ProdGas, col='steelblue', xlab = 'Prod Gas Mm3/d', ylab = 'Numero de pozos', main = "Distribución de Producción de GAS en pozos NC - YPF")
abline(v = mean(ProdPet), col='blue', lwd = 1)
```



## Profundidad de los Pozos



```{r}
summary(datos$profundidad)
```
Si bien es un dato relativo, porque mucho de los pozos son horizontal, se podria desprender de estos valores que el promedio de profundiad de los pozos es de 3935m. El máximo valor corresponde a 7784 (por el valor se interpreta que incluye el tramo horizontal) y que los pozos con valor de profundiad 0 son los que no tienen cargados estos datos en el dataset.



* Gráfica de las profundidades

```{r}
plot(datos$profundidad,  col='steelblue', xlab = 'Pozos', ylab = 'Profundidad', main = "Profundiad de los pozos NC - YPF")
```

library(sp)
library(sf)

library(readr)

leaflet

proyecto copernicus





## Estado de pozo en extracción efectiva


```{r}
TipoEstado <- c(datos$tipoestado)

```


```{r}
dataf_tipoestado <- data.frame(TipoEstado, ProdGas, ProdPet)
dataf_tipoestado

ExtraccionEfectiva <- subset(dataf_tipoestado, TipoEstado == "Extraccion Efectiva")
ExtraccionEfectiva

```

* Producción Pet

```{r}
hist(ExtraccionEfectiva$ProdPet, breaks = 100, col='steelblue', xlab = 'Prod Pet m3/d', ylab = 'Numero de pozos en Extracción efectiva', main = "Producción de Petróleo en pozos NC - YPF")
```

* Producción Gas


```{r}
hist(ExtraccionEfectiva$ProdGas, breaks = 100, col='steelblue', xlab = 'Prod Gas Mm3/d', ylab = 'Numero de pozos en Extracción efectiva', main = "Producción de GAS en pozos NC - YPF")
```


* Produccion "real"

```{r}
summary(ExtraccionEfectiva$ProdPet)
```




```{r}
summary(ExtraccionEfectiva$ProdGas)
```


## Mapa


```{r}
plot(datos$coordenadax, datos$coordenaday)
```













DESDE ACA SE AGREGARON NUEVOS ANALISIS

### Caso de Estudio

## Cantidad de pozos


```{r}
cantidad_pozos <- c(datos$idpozo)
length (cantidad_pozos)
```


## Promedio de la produccion de petroleo

```{r}
prom_pet <- mean(Produccion_NC_YPF$prod_pet)
prom_pet
```

## Promedio de la produccion de gas

```{r}
prom_gas <- mean(Produccion_NC_YPF$prod_gas)
prom_gas
```
## Promedio de la produccion de agua

```{r}
prom_agua <- mean(Produccion_NC_YPF$prod_agua)
prom_agua
```


## Distribucion Normal

```{r}
x <- seq(-4, 4, length.out=1000)
dnorm_pet <- dnorm(x)
plot(dnorm_pet, type="l")
```


## Boxplot para ver si hay outlayer - Profundidad de los pozos


Podemos llegar a la conclusion que la profundidad que la mayor profundidad reflejada de los pozos estan entre los 2000 y 6000 metros




## Ploteos de Densidad


```{r}
par(mfrow=c(2,2))
plot(density(Produccion_NC_YPF$prod_pet))
plot(density(Produccion_NC_YPF$prod_gas))
plot(density(Produccion_NC_YPF$prod_agua))
```


## Ploteo

```{r}
plot(sort(Produccion_NC_YPF$prod_pet))
plot(sort(Produccion_NC_YPF$prod_gas))
plot(sort(Produccion_NC_YPF$prod_agua))

```


## Comparacion de variables (Petroleo - Gas - Agua) producido


```{r}
plot(Produccion_NC_YPF$prod_pet,Produccion_NC_YPF$prod_gas)
abline(h=prom_pet, col="red")
abline(v=prom_gas, col="blue")
```





## Maxima Produccion

# Ubicacion de la fila:

```{r}
which.max(Produccion_NC_YPF$prod_pet)

```
# Ubicacion del valor:

```{r}
Produccion_NC_YPF$prod_pet[68]
```




## Minima Produccion

# Ubicacion de la fila:

```{r}
which.min(Produccion_NC_YPF$prod_pet)
```
# Ubicacion del valor:

```{r}
Produccion_NC_YPF$prod_pet[1]
```


## Metodo Clara

plot(clara(petroleo,3))

## 


```{r}
                                       
data <- data.frame(ProdPet= rnorm(100),
                   ProdGas = letters[1:5])
head(data)
```











## Asignaciones de variables

```{r}

tipo_ext <- c(datos$tipoextraccion)

tipo_pz <- c(datos$tipopozo)

profundidad <- c(datos$profundidad)

area <- c(datos$areapermisoconcesion)

prov <- c(datos$provincia)

sub_tipo_rec <- c(datos$sub_tipo_recurso)



```




### DIAGRAMAS/GRAFICOS -  PROFUNDIDAD


```{r}
hist(profundidad,  main = "Gráfico de Barras - Profundidad", ylab="Cantidad relativa de pozos",xlab="Profundidad")
```
```{r}
Densidad <- density(profundidad)
Densidad
```
# Grafico de densidad - profundidad

```{r}
plot(density(profundidad), main = "Gráfico de Densidad - Profundidad", ylab="Cantidad relativa de pozos",xlab="Profundidad")
```






# Grafico de densidad

```{r}
plot(density(ProdPet), main = "Gráfico de Densidad - Produccion Petroleo", ylab="Cantidad relativa de pozos",xlab="porduccion")
```





```{r}
plot(sort(profundidad))
```



```{r}

plot(ExtraccionEfectiva)
```















### DESDE ACA SERIA NICO, HAY QUE SACARLE EL DE "TIPODEESTADO" QUE LO HABIAS HECHO CON EL TUYO.HAY ASIGNACION DE VARIABLES EN LA LINEA 375


## Area de Concesion

· Damos a conocer las areas en donde se encuentran los pozos NC

```{r}
# Damos a conocer las areas en donde se encuentran los pozos NC

AGUADA_DE_LA_ARENA <- c(length (which (area == "AGUADA DE LA ARENA")))
AGUADA_DE_LA_ARENA

AGUADA_DEL_CHANAR <- c(length (which (area == "AGUADA DEL CHANAR")))
AGUADA_DEL_CHANAR

AL_NORTE_DE_LA_DORSA <- c(length (which (area == "AL NORTE DE LA DORSAL")))
AL_NORTE_DE_LA_DORSA

BAJO_DEL_TORO <- c(length (which (area == "BAJO DEL TORO")))
BAJO_DEL_TORO

BAJO_DEL_TORO_NORTE <- c(length (which (area == "BAJO DEL TORO NORTE")))
BAJO_DEL_TORO_NORTE

BANDURRIA_SUR <- c(length (which (area == "BANDURRIA SUR")))
BANDURRIA_SUR

CERRO_ARENA <- c(length (which (area == "CERRO ARENA")))
CERRO_ARENA

CERRO_LAS_MINAS <- c(length (which (area == "CERRO LAS MINAS")))
CERRO_LAS_MINAS

CERRO_MANRIQUE <- c(length (which (area == "CERRO MANRIQUE")))
CERRO_MANRIQUE

CHIUIDO_DE_LA_SIERRA_NEGRAS <- c(length (which (area == "CHIUIDO DE LA SIERRA NEGRAS")))
CHIUIDO_DE_LA_SIERRA_NEGRAS

CN_VII_A <- c(length (which (area == "CN VII A")))
CN_VII_A

DADIN <- c(length (which (area == "DADIN")))
DADIN

EL_OREJANO <- c(length (which (area == "EL OREJANO")))
EL_OREJANO

ESTACION_FERNADEZ_ORO <- c(length (which (area == "ESTACION FERNADEZ ORO")))
ESTACION_FERNADEZ_ORO

FILO_MORADO <- c(length (which (area == "FILO MORADO")))
FILO_MORADO

LA_AMARGA_CHICA <- c(length (which (area == "LA AMARGA CHICAL")))
LA_AMARGA_CHICA

LA_RIBERA_BLOQUE_I <- c(length (which (area == "LA RIBERA BLOQUE I")))
LA_RIBERA_BLOQUE_I

LA_RIBERA_BLOQUE_II <- c(length (which (area == "LA RIBERA BLOQUE II")))
LA_RIBERA_BLOQUE_II

LAS_MANADAS <- c(length (which (area == "LAS MANADAS")))
LAS_MANADAS

LAS_TACANAS <- c(length (which (area == "LAS TACANAS")))
LAS_TACANAS

LOMA_AMARILLA_SUR <- c(length (which (area == "LOMA AMARILLA SUR")))
LOMA_AMARILLA_SUR

LOMA_CAMPANA <- c(length (which (area == "LOMA CAMPANA")))
LOMA_CAMPANA

LOMA_DEL_MOLLE <- c(length (which (area == "LOMA DEL MOLLE")))
LOMA_DEL_MOLLE

LOMA_LA_LATA_SIERRA_BARROSA <- c(length (which (area == "LOMA LA LATA-SIERRA BARROSA")))
LOMA_LA_LATA_SIERRA_BARROSA

LOS_CALDENES <- c(length (which (area == "LOS CALDENES")))
LOS_CALDENES

OCTOGONO <- c(length (which (area == "OCTOGONO")))
OCTOGONO

PASO_DE_LAS_BARDAS_NORTE <- c(length (which (area == "PASO DE LAS BARDAS NORTE")))
PASO_DE_LAS_BARDAS_NORTE

RINCON_DEL_MANGRULLO <- c(length (which (area == "RINCON DEL MANGRULLO")))
RINCON_DEL_MANGRULLO

RIO_NEUQUEN <- c(length (which (area == "RIO Neuquen")))
RIO_NEUQUEN

VALLE_DEL_RIO_GRANDE <- c(length (which (area == "VALLE DEL RIO GRANDE")))
VALLE_DEL_RIO_GRANDE



data.frame(AGUADA_DE_LA_ARENA, AGUADA_DEL_CHANAR, AL_NORTE_DE_LA_DORSA, BAJO_DEL_TORO, BAJO_DEL_TORO_NORTE, BANDURRIA_SUR, CERRO_ARENA, CERRO_LAS_MINAS, CERRO_MANRIQUE, CHIUIDO_DE_LA_SIERRA_NEGRAS, CN_VII_A, DADIN, EL_OREJANO, ESTACION_FERNADEZ_ORO, FILO_MORADO, LA_AMARGA_CHICA, LA_RIBERA_BLOQUE_I, LA_RIBERA_BLOQUE_II, LAS_MANADAS, LAS_TACANAS, LOMA_AMARILLA_SUR, LOMA_CAMPANA, LOMA_DEL_MOLLE, LOMA_LA_LATA_SIERRA_BARROSA, LOS_CALDENES, OCTOGONO, PASO_DE_LAS_BARDAS_NORTE, RINCON_DEL_MANGRULLO, RIO_NEUQUEN, VALLE_DEL_RIO_GRANDE)
```


# Determinamos la cantidad de areas 


```{r}
# Determinar la cantidad Se designa una variable "cantidad_area" para contabilizar

Areas <- c(data.frame(AGUADA_DE_LA_ARENA, AGUADA_DEL_CHANAR, AL_NORTE_DE_LA_DORSA, BAJO_DEL_TORO, BAJO_DEL_TORO_NORTE, BANDURRIA_SUR, CERRO_ARENA, CERRO_LAS_MINAS, CERRO_MANRIQUE, CHIUIDO_DE_LA_SIERRA_NEGRAS, CN_VII_A, DADIN, EL_OREJANO, ESTACION_FERNADEZ_ORO, FILO_MORADO, LA_AMARGA_CHICA, LA_RIBERA_BLOQUE_I, LA_RIBERA_BLOQUE_II, LAS_MANADAS, LAS_TACANAS, LOMA_AMARILLA_SUR, LOMA_CAMPANA, LOMA_DEL_MOLLE, LOMA_LA_LATA_SIERRA_BARROSA, LOS_CALDENES, OCTOGONO, PASO_DE_LAS_BARDAS_NORTE, RINCON_DEL_MANGRULLO, RIO_NEUQUEN, VALLE_DEL_RIO_GRANDE))

cantidad_areas <- c(Areas)
length (cantidad_areas)

```



## PROVINCIAS - Cantidad de pozos por provincias

```{r}

Neuquen <- length (which (prov == "Neuquen"))
Neuquen
Rio_Negro <- length (which (prov == "Rio Negro"))
Rio_Negro
Mendoza <- length (which (prov == "Mendoza"))
Mendoza

data.frame(Neuquen, Rio_Negro, Mendoza)
```




## TIPOS DE EXTRACCION (Equipo de extraccion)

```{r}
BOMBEO_MECANICO <- length (which (tipo_ext == "Bombeo Mecanico"))
BOMBEO_MECANICO
GAS_LIFT <- length (which (tipo_ext == "Gas Lift"))
GAS_LIFT
PLUNGER_LIFT <- length (which (tipo_ext == "Plunger Lift"))
PLUNGER_LIFT
SIN_SISTEMA_DE_EXTRACCION <- length (which (tipo_ext == "Sin Sistema de Extraccion"))
SIN_SISTEMA_DE_EXTRACCION
SURGENCIA_NATURAL <- length (which (tipo_ext == "Surgencia Natural"))
SURGENCIA_NATURAL

data.frame(BOMBEO_MECANICO, GAS_LIFT, PLUNGER_LIFT,SIN_SISTEMA_DE_EXTRACCION,SURGENCIA_NATURAL)

```

##  Determinamos los diferentes tipos de extracciones que en loz pozos NC

· Se asigna la variable "tipo_extraccion"


```{r}
tipo_extraccion <- c( BOMBEO_MECANICO, GAS_LIFT, PLUNGER_LIFT,SIN_SISTEMA_DE_EXTRACCION,SURGENCIA_NATURAL)

length (tipo_extraccion)

```






## Tipo de estado de pozos

```{r}
EE <- nrow(subset(datos, datos$tipoestado == "Extraccion Efectiva"))


ES <- nrow(subset(datos, datos$tipoestado == "En Estudio"))


PT <- nrow(subset(datos, datos$tipoestado == "Parado Transitoriamente"))

data.frame(EE, ES, PT)
```

```{r}
tipoestado1 <- c(EE, ES, PT)
tipoestado1
```

```{r}
etiquetas_2 <- c("Extraccion Efectiva", "En Estudio", "Parado Transitorio")
etiquetas_2
```

```{r}
etiquetas <- paste(etiquetas_2, tipoestado1)
etiquetas
```

```{r}
pie(tipoestado1, etiquetas,
    main = "Gráfico de torta ",
    sub = "Clasificacion de tipo de estado")
```



## Subtipos de pozos


```{r}
SHALE <- c(length (which (sub_tipo_rec == "SHALE")))
SHALE

TIGHT <- c(length (which (sub_tipo_rec == "TIGHT")))
TIGHT

data.frame(SHALE, TIGHT)
```

```{r}
# Determinamos la diferencia del sub tipo de recurso
subtipo <- c(SHALE, TIGHT)
subtipo
```
```{r}
etiquetas_1 <- c("SHALE", "TIGHT")
etiquetas_1
```
```{r}
etiquetas <- paste(etiquetas_1, subtipo)
etiquetas
```
```{r}
pie(subtipo, etiquetas,
    main = "Grafico Subtipos de pozos",
    sub = "Clasificacion ")
```





```{r}
library(car)
BSC_rawdata <- datos [, c(4,29)]
BSC_rawdata




```

```{r}
x <-(data.frame(SHALE, TIGHT))
x
```




## Graficos comparativos promedios de produccion

```{r}
promedios <- c(prom_pet, prom_gas, prom_agua)
promedios
```


```{r}
etiquetas <- c("Petroleo", "Gas", "Agua")
etiquetas
```
```{r}
etiquetas <- paste(etiquetas, promedios)
etiquetas
```
```{r}
etiquetas <- paste(etiquetas, "%", sep = "")
etiquetas
```

```{r}
pie(promedios, etiquetas,
    main = "Promedio de los Fluidos Producidos",
    sub = "Clasificacion")
```
